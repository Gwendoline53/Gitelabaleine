{% extends 'base.html.twig' %}

{% block title %}DÃ©couvrir{% endblock %}

{% block body %}
{% include 'navbar/index.html.twig' %}

{% if mode_edition|default(false) %}
<div class="locale-selector">
    <a href="{{ path('admin_decouvrir', {locale: 'fr'}) }}">FranÃ§ais</a> | 
    <a href="{{ path('admin_decouvrir', {locale: 'En'}) }}">English</a>
</div>
{% endif %}

<div class="Decouvrir-container">
    <div class="Decouvrirdecor-wrapper">
        <div class="Decouvrirdecor-gauche"></div>

        <div class="Decouvrir-texte">
            <h1 class="titreDecouvrir elegant-underline"
                {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre"{% endif %}>
                {{ contenus.titre|default('DÃ©couvrir :')|raw }}
            </h1>

            <div class="texte-section">
                <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="p1"{% endif %}>
                    {{ contenus.p1|default("Blotti entre les frondaisons dâ€™une forÃªt douce et les embruns de la mer toute proche, notre gÃ®te vous accueille Ã  La Baleine, charmant village du dÃ©partement de la Manche (50450), oÃ¹ le temps semble ralentir au rythme des saisons.")|raw }}
                </p>

                <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="p2"{% endif %}>
                    {{ contenus.p2|default("Ici, le chant des oiseaux se mÃªle au murmure du vent dans les feuillages, et Ã  quelques kilomÃ¨tres, lâ€™ocÃ©an vous attend â€” sauvage, libre, toujours changeant. NichÃ© dans un Ã©crin de verdure, notre gÃ®te est une parenthÃ¨se hors du tumulte, un lieu pour respirer, marcher, rÃªver.")|raw }}
                </p>

                <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="p3"{% endif %}>
                    {{ contenus.p3|default("Ã€ lâ€™aube, la lumiÃ¨re filtre Ã  travers les arbres. Ã€ la tombÃ©e du jour, câ€™est la mer qui vous appelle pour une derniÃ¨re promenade. Que vous veniez pour vous reposer, explorer les sentiers forestiers, dÃ©couvrir les plages secrÃ¨tes de la cÃ´te ou simplement vous reconnecter Ã  lâ€™essentiel, ce lieu a Ã©tÃ© pensÃ© pour vous.")|raw }}
                </p>

                <div class="liste-atouts">
                    <h2 class="titre-liste">ğŸƒ Ce que vous trouverez ici :</h2>
                    <ul {% if mode_edition|default(false) %}contenteditable="true" data-cle="p4"{% endif %}>
                        <li>Une maison chaleureuse, mÃªlant confort moderne et charme rustique</li>
                        <li>Une forÃªt Ã  votre porte, idÃ©ale pour randonner, lire ou ne rien faire</li>
                        <li>La mer Ã  quelques minutes, avec ses plages paisibles et ses falaises</li>
                        <li>Le calme absolu dâ€™un village discret, Ã  lâ€™Ã©cart des foules</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="Decouvrirdecor-droite"></div>
    </div>

    <div class="Decouvrirdecor-bas"></div>
</div>

{% if mode_edition|default(false) %}
<div class="btn-containervaliderDecouvrir">
    <button id="btn-validerDecouvrir">Valider les modifications</button>
</div>

<script>
    document.querySelectorAll('[contenteditable="true"]').forEach(el => {
        el.addEventListener('blur', () => {
            const cle = el.dataset.cle;
            const texte = el.innerHTML.trim();
            const locale = '{{ locale|default("fr") }}';

            fetch('{{ path("admin_update_contenu") }}', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ cle: cle, texte: texte, locale: locale })
            })
            .then(response => response.json())
            .then(data => {
                if (!data.success) {
                    alert("Erreur lors de la sauvegarde");
                }
            });
        });
    });

    document.getElementById('btn-validerDecouvrir').addEventListener('click', () => {
        window.location.href = '{{ path("admin_gestion") }}';
    });
</script>
{% endif %}
{% include 'footer/index.html.twig' %}
{% endblock %}