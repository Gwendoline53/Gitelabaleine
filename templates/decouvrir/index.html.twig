{% extends 'base.html.twig' %}

{% block title %}Découvrir{% endblock %}

{% block body %}
{{ render(path('app_navbar')) }}

{% if mode_edition|default(false) %}
<div class="Decouvrirlocale-selector">
    <a href="{{ path('admin_decouvrir', {locale: 'fr'}) }}" class="{{ locale == 'fr' ? 'active' : '' }}">Français</a> | 
    <a href="{{ path('admin_decouvrir', {locale: 'en'}) }}" class="{{ locale == 'en' ? 'active' : '' }}">English</a>
</div>
{% endif %}

<div class="Decouvrir-container">
    <div class="Decouvrirdecor-wrapper">
        <div class="Decouvrirdecor-gauche"></div>

        <div class="Decouvrir-texte">
            <h1 class="titreDecouvrir elegant-underline"
                {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre"{% endif %}>
                {{ contenus.titre|default('Découvrir :')|raw }}
            </h1>

            <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="p1"{% endif %}>
                {{ contenus.p1|default("Blotti entre les frondaisons d’une forêt douce et les embruns de la mer toute proche, notre gîte vous accueille à La Baleine, charmant village du département de la Manche (50450), où le temps semble ralentir au rythme des saisons.Ici, le chant des oiseaux se mêle au murmure du vent dans les feuillages, et à quelques kilomètres, l’océan vous attend, sauvage, libre, toujours changeant. Niché dans un écrin de verdure, notre gîte est une parenthèse hors du tumulte, un lieu pour respirer, marcher, rêver.À l’aube, la lumière filtre à travers les arbres. À la tombée du jour, c’est la mer qui vous appelle pour une dernière promenade. Que vous veniez pour vous reposer, explorer les sentiers forestiers, découvrir les plages secrètes de la côte ou simplement vous reconnecter à l’essentiel, ce lieu a été pensé pour vous.")|raw }}
            </p>

            <div class="liste-atouts">
                <h2 class="titre-liste">{{ contenus.p6|default("Ce que vous trouverez ici :")|raw }}</h2>
                <ul {% if mode_edition|default(false) %}contenteditable="true" data-cle="p4"{% endif %}>
                    <p>{{ contenus.p7|default("Une maison chaleureuse, mêlant confort moderne et charme rustique")|raw }}</p>
                    <p>{{ contenus.p8|default("Une forêt à votre porte, idéale pour randonner, lire ou ne rien faire")|raw }}</p>
                    <p>{{ contenus.p9|default("La mer à quelques minutes, avec ses plages paisibles et ses falaises")|raw }}</p>
                    <p>{{ contenus.p10|default("Le calme absolu d’un village discret, à l’écart des foules")|raw }}</p>
                </ul>
            </div>
        </div>
        <div class="Decouvrirdecor-droite"></div>
    </div>
</div>

{% if mode_edition|default(false) %}
<div class="btn-containervaliderDecouvrir">
    <button id="btn-validerDecouvrir">Valider les modifications</button>
</div>

<script>
    document.querySelectorAll('[contenteditable="true"]').forEach(el => {
        el.addEventListener('blur', () => {
            const cle = el.dataset.cle;
            const texte = el.innerHTML.trim();
            const locale = '{{ locale|default("fr") }}';

            fetch('{{ path("admin_update_contenu") }}', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ cle: cle, texte: texte, locale: locale })
            })
            .then(response => response.json())
            .then(data => {
                if (!data.success) {
                    alert("Erreur lors de la sauvegarde");
                }
            });
        });
    });

    document.getElementById('btn-validerDecouvrir').addEventListener('click', () => {
        window.location.href = '{{ path("admin_gestion") }}';
    });
</script>
{% endif %}

{% include 'footer/index.html.twig' %}
{% endblock %}