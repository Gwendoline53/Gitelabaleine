{% extends 'base.html.twig' %}

{% block title %}Acceuil
{% endblock %}

{% block body %}
{% include 'navbar/index.html.twig' %}
{% if mode_edition|default(false) %}
<div class="locale-selector">
    <a href="{{ path('admin_home', {locale: 'fr'}) }}">Français</a> | 
    <a href="{{ path('admin_home', {locale: 'En'}) }}">English</a>
</div>
{% endif %}
	<div class="page-wrapper">
		<div class="logolabaleine"></div>
		<div class="ecriturefond1"></div>
		<button class="btnhome1" onclick="window.location.href='{{ path('app_decouvrir') }}'">Découvrir</button>
		<div class="image1"></div>
		<div class="ecriturefond2"></div>
		<button class="btnhome2" onclick="window.location.href='{{ path('app_formulaire') }}'">Réserver</button>
		<div class="fleure"></div>
		<div class="image2"></div>
		<button class="btnhome3" onclick="window.location.href='{{ path('app_decouvrir') }}'">En savoir plus</button>
		<div class="image3"></div>
		<div class="coquelico"></div>
	</div>
{% if mode_edition|default(false) %}
<div class="btn-containervaliderhome">
  <button id="btn-validerhome">Valider les modifications</button>
</div>
<script>
  // Envoi automatique au blur
  document.querySelectorAll('[contenteditable="true"]').forEach(el => {
      el.addEventListener('blur', () => {
          const cle = el.dataset.cle;
          const texte = el.innerText.trim();
          const locale = '{{ locale|default('fr') }}';

          fetch('{{ path("admin_home_update") }}', {
              method: 'POST',
              headers: {'Content-Type': 'application/json'},
              body: JSON.stringify({cle: cle, texte: texte, locale: locale})
          })
          .then(response => response.json())
          .then(data => {
              if (!data.success) {
                  alert('Erreur lors de la sauvegarde');
              }
          });
      });
  });

  document.getElementById('btn-validerhome').addEventListener('click', () => {
    window.location.href = '{{ path('admin_gestion') }}';
  });
</script>
{% endif %}
	{% include 'footer/index.html.twig' %}
{% endblock %}
